{"version":3,"file":"map.js","sources":["../../../src/-private/new/map.ts"],"sourcesContent":["import { trackedMap, trackedWeakMap } from '@ember/reactive/collections';\n\nconst mapConfig = {\n  equals: () => false,\n  description: 'TrackedMap from tracked-built-ins',\n};\nconst weakMapConfig = {\n  equals: () => false,\n  description: 'TrackedWeakMap from tracked-built-ins',\n};\n\nexport class TrackedMap {\n  constructor(existing: any) {\n    const reactive = trackedMap(existing, mapConfig);\n\n    return new Proxy(reactive, {\n      get(target, prop) {\n        const value = Reflect.get(target, prop, target);\n\n        if (typeof value === 'function') {\n          return value.bind(target);\n        }\n        return value;\n      },\n      getPrototypeOf() {\n        return TrackedMap.prototype;\n      },\n    });\n  }\n}\n\nexport class TrackedWeakMap {\n  constructor(values: any) {\n    const reactive = trackedWeakMap(values, weakMapConfig);\n\n    return new Proxy(reactive, {\n      get(target, prop) {\n        const value = Reflect.get(target, prop, target);\n\n        if (typeof value === 'function') {\n          return value.bind(target);\n        }\n        return value;\n      },\n      getPrototypeOf() {\n        return TrackedWeakMap.prototype;\n      },\n    });\n  }\n}\n\n// Ensure instanceof works correctly\nObject.setPrototypeOf(TrackedMap.prototype, Map.prototype);\nObject.setPrototypeOf(TrackedWeakMap.prototype, WeakMap.prototype);\n"],"names":["mapConfig","equals","description","weakMapConfig","TrackedMap","constructor","existing","reactive","trackedMap","Proxy","get","target","prop","value","Reflect","bind","getPrototypeOf","prototype","TrackedWeakMap","values","trackedWeakMap","Object","setPrototypeOf","Map","WeakMap"],"mappings":";;AAEA,MAAMA,SAAS,GAAG;EAChBC,MAAM,EAAEA,MAAM,KAAK;AACnBC,EAAAA,WAAW,EAAE;AACf,CAAC;AACD,MAAMC,aAAa,GAAG;EACpBF,MAAM,EAAEA,MAAM,KAAK;AACnBC,EAAAA,WAAW,EAAE;AACf,CAAC;AAEM,MAAME,UAAU,CAAC;EACtBC,WAAWA,CAACC,QAAa,EAAE;AACzB,IAAA,MAAMC,QAAQ,GAAGC,UAAU,CAACF,QAAQ,EAAEN,SAAS,CAAC;AAEhD,IAAA,OAAO,IAAIS,KAAK,CAACF,QAAQ,EAAE;AACzBG,MAAAA,GAAGA,CAACC,MAAM,EAAEC,IAAI,EAAE;QAChB,MAAMC,KAAK,GAAGC,OAAO,CAACJ,GAAG,CAACC,MAAM,EAAEC,IAAI,EAAED,MAAM,CAAC;AAE/C,QAAA,IAAI,OAAOE,KAAK,KAAK,UAAU,EAAE;AAC/B,UAAA,OAAOA,KAAK,CAACE,IAAI,CAACJ,MAAM,CAAC;AAC3B,QAAA;AACA,QAAA,OAAOE,KAAK;MACd,CAAC;AACDG,MAAAA,cAAcA,GAAG;QACf,OAAOZ,UAAU,CAACa,SAAS;AAC7B,MAAA;AACF,KAAC,CAAC;AACJ,EAAA;AACF;AAEO,MAAMC,cAAc,CAAC;EAC1Bb,WAAWA,CAACc,MAAW,EAAE;AACvB,IAAA,MAAMZ,QAAQ,GAAGa,cAAc,CAACD,MAAM,EAAEhB,aAAa,CAAC;AAEtD,IAAA,OAAO,IAAIM,KAAK,CAACF,QAAQ,EAAE;AACzBG,MAAAA,GAAGA,CAACC,MAAM,EAAEC,IAAI,EAAE;QAChB,MAAMC,KAAK,GAAGC,OAAO,CAACJ,GAAG,CAACC,MAAM,EAAEC,IAAI,EAAED,MAAM,CAAC;AAE/C,QAAA,IAAI,OAAOE,KAAK,KAAK,UAAU,EAAE;AAC/B,UAAA,OAAOA,KAAK,CAACE,IAAI,CAACJ,MAAM,CAAC;AAC3B,QAAA;AACA,QAAA,OAAOE,KAAK;MACd,CAAC;AACDG,MAAAA,cAAcA,GAAG;QACf,OAAOE,cAAc,CAACD,SAAS;AACjC,MAAA;AACF,KAAC,CAAC;AACJ,EAAA;AACF;;AAEA;AACAI,MAAM,CAACC,cAAc,CAAClB,UAAU,CAACa,SAAS,EAAEM,GAAG,CAACN,SAAS,CAAC;AAC1DI,MAAM,CAACC,cAAc,CAACJ,cAAc,CAACD,SAAS,EAAEO,OAAO,CAACP,SAAS,CAAC;;;;"}